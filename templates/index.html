<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ëˆ„ì  ë‹¨ì–´ ì‹œí—˜ì§€ ìƒì„±ê¸°</title>
    <style>
        /* CSS ìŠ¤íƒ€ì¼ì€ ì´ì „ê³¼ ë™ì¼í•˜ê²Œ ìœ ì§€ë©ë‹ˆë‹¤. */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');
        body{font-family:'Noto Sans KR',sans-serif;background-color:#f4f7f6;color:#333;display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0}
        .container{background-color:#fff;padding:40px;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,.1);max-width:500px;width:90%;text-align:center;transition:transform .2s ease-in-out}
        .container:hover{transform:translateY(-5px)}
        h1{font-weight:700;font-size:28px;color:#2c3e50;margin-bottom:15px}
        p{color:#555;font-size:16px;line-height:1.6;margin-bottom:30px}
        .flash-error{display:none;background-color:#ffebee;color:#c62828;padding:15px;border-radius:8px;margin-bottom:20px;border:1px solid #ef9a9a}
        .file-upload-wrapper{margin-bottom:20px}
        .file-upload-label{display:inline-block;padding:12px 25px;background-color:#3498db;color:#fff;border-radius:8px;cursor:pointer;font-weight:500;transition:background-color .3s}
        .file-upload-label:hover{background-color:#2980b9}
        #wordFile{display:none}
        #file-name-display{margin-top:15px;font-size:14px;color:#777;height:20px}
        .submit-btn{width:100%;padding:15px;background-image:linear-gradient(45deg,#2980b9,#3498db);color:#fff;border:none;border-radius:8px;font-size:18px;font-weight:700;cursor:pointer;transition:all .3s;box-shadow:0 4px 15px rgba(52,152,219,.4)}
        .submit-btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(52,152,219,.5)}
        .submit-btn:disabled{background-image:none;background-color:#ccc;cursor:not-allowed;box-shadow:none}
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“ ëˆ„ì  ë‹¨ì–´ ì‹œí—˜ì§€ ìƒì„±ê¸°</h1>
        <p>ë‹¨ì–´ ëª©ë¡ì´ í¬í•¨ëœ '.docx' íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬<br>ëˆ„ì  ë‹¨ì–´ ì‹œí—˜ì§€ë¥¼ ê°„í¸í•˜ê²Œ ë§Œë“¤ì–´ë³´ì„¸ìš”.</p>
        
        <div class="flash-error" id="error-message"></div>

        <form id="upload-form">
            <div class="file-upload-wrapper">
                <label for="wordFile" class="file-upload-label">ë‹¨ì–´ ëª©ë¡ íŒŒì¼ ì„ íƒ</label>
                <input type="file" name="wordFile" id="wordFile" accept=".docx" style="display: none;">
            </div>
            <div id="file-name-display">íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.</div>
            <br>
            <button type="submit" class="submit-btn" id="submit-button">ì‹œí—˜ì§€ ìƒì„± ë° ë‹¤ìš´ë¡œë“œ</button>
        </form>
    </div>

    <script>
        const uploadForm = document.getElementById('upload-form');
        const wordFileInput = document.getElementById('wordFile');
        const fileNameDisplay = document.getElementById('file-name-display');
        const submitButton = document.getElementById('submit-button');
        const errorMessageDiv = document.getElementById('error-message');

        wordFileInput.addEventListener('change', function() {
            fileNameDisplay.textContent = this.files.length > 0 ? this.files[0].name : 'íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.';
        });

        uploadForm.addEventListener('submit', function(event) {
            event.preventDefault();

            if (!wordFileInput.files[0]) {
                showError('íŒŒì¼ì„ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            const formData = new FormData();
            formData.append('wordFile', wordFileInput.files[0]);

            submitButton.disabled = true;
            submitButton.textContent = 'ì²˜ë¦¬ ì¤‘...';
            hideError();

            fetch('/generate', {
                method: 'POST',
                body: formData,
            })
            .then(response => {
                if (!response.ok) {
                    return response.json().then(err => { throw new Error(err.error || 'ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜') });
                }
                return response.json();
            })
            .then(data => {
                if (data.downloadUrl) {
                    window.location.href = data.downloadUrl;
                } else {
                    throw new Error(data.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜');
                }
            })
            .catch(error => {
                showError(error.message);
            })
            .finally(() => {
                submitButton.disabled = false;
                submitButton.textContent = 'ì‹œí—˜ì§€ ìƒì„± ë° ë‹¤ìš´ë¡œë“œ';
            });
        });

        function showError(message) {
            errorMessageDiv.textContent = message;
            errorMessageDiv.style.display = 'block';
        }
        
        function hideError() {
            errorMessageDiv.style.display = 'none';
        }
    </script>
</body>
</html>